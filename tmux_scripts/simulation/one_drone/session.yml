name: simulation
root: ./
startup_window: takeoff/land
pre_window: export ROS_DOMAIN_ID=99; export DRONE_DEVICE_ID=ssrc_fog_x; export UAV_NAME=uav1;

windows:
  - simulation:
      layout: tiled
      panes:
        - ros2 launch fog_gazebo_resources gazebo.launch.py world:=`ros2 pkg prefix fog_gazebo_resources`/worlds/forest.world gui:=false
        - 'history -s ros2 launch gazebo_ros gzclient.launch.py'
        - bash `ros2 pkg prefix fog_gazebo_resources`/scripts/spawn_drone.sh ~/git/px4-firmware
  - micrortps_agent:
      layout: tiled
      panes:
        - micrortps_agent -t UDP
  - control:
      layout: tiled
      panes:
        - ros2 launch control_interface control_interface.py use_sim_time:=true
  - sensors:
      layout: tiled
      panes:
        - ros2 launch fog_core static_tf_launch.py
  - navigation:
      layout: even-vertical
      panes:
        - ros2 launch navigation navigation.py use_sim_time:=true
        - 'history -s ros2 run navigation waypoint_publisher.py'
        - 'history -s ros2 service call /$UAV_NAME/navigation/goto_start std_srvs/Trigger {}'
  - octomap_server:
      layout: tiled
      panes:
        - ros2 launch octomap_server2 tii_rplidar_launch.py use_sim_time:=true
  - takeoff/land:
      layout: tiled
      panes:
        - 'history -s ros2 service call /$UAV_NAME/control_interface/arming std_srvs/srv/SetBool \"data: true\"'
        - 'history -s ros2 service call /$UAV_NAME/control_interface/takeoff std_srvs/srv/SetBool \"data: true\"'
        - 'history -s ros2 service call /$UAV_NAME/control_interface/land std_srvs/srv/SetBool \"data: true\"'
  - status:
      layout: tiled
      panes:
        - 'history -s ros2 topic echo /VehicleStatus_PubSubTopic'
        - 'history -s ros2 topic echo /VehicleCommandAck_PubSubTopic'
  - goto:
      layout: even-vertical
      panes:
        - 'history -s ros2 service call /$UAV_NAME/control_interface/local_setpoint fog_msgs/srv/Vec4 \"goal: \[0, 0, 2, 1\]\"'
        - 'history -s ros2 run navigation waypoint_publisher.py'
        - 'history -s ros2 service call /$UAV_NAME/navigation/goto_start std_srvs/Trigger {}'
  - rviz:
      layout: tiled
      panes:
        - ros2 launch octomap_server2 rviz_launch.py
